ControlId,FeatureName,Status,SupportedResources,Severity,PropertyPath,LineNumber,CurrentValue,ExpectedProperty,ExpectedValue,ResourcePath,ResourceLineNumber,Description,FilePath
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled,'True',"resources[0] , resources[2]",341,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,"resources[0] , resources[2]",341,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_Managed_Service_Identity,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.identity.type,Allow 'SystemAssigned',"resources[0] , resources[2]",341,Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled,'True',"resources[4] , resources[6]",510,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,"resources[4] , resources[6]",510,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_Managed_Service_Identity,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.identity.type,Allow 'SystemAssigned',"resources[4] , resources[6]",510,Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled,'True',"resources[8] , resources[10]",716,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,"resources[8] , resources[10]",716,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_Managed_Service_Identity,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.identity.type,Allow 'SystemAssigned',"resources[8] , resources[10]",716,Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled,'True',"resources[12] , resources[13]",853,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,"resources[12] , resources[13]",853,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_Managed_Service_Identity,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.identity.type,Allow 'SystemAssigned',"resources[12] , resources[13]",853,Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled,'True',"resources[22] , resources[21]",1184,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,"resources[22] , resources[21]",1184,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_Managed_Service_Identity,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.identity.type,Allow 'SystemAssigned',"resources[22] , resources[21]",1184,Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled,'True',resources[24],1346,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,resources[24],1346,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_Managed_Service_Identity,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.identity.type,Allow 'SystemAssigned',resources[24],1346,Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled,'True',"resources[28] , resources[27]",1490,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,"resources[28] , resources[27]",1490,App Service must authenticate users using Azure Active Directory backed credentials,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_AuthN_Use_Managed_Service_Identity,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.identity.type,Allow 'SystemAssigned',"resources[28] , resources[27]",1490,Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_Multiple_Instances,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.sku.capacity,GreaterThan 1,"resources[0] , resources[2]",412,App Service must be deployed on a minimum of two instances to ensure availability,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_Multiple_Instances,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.sku.capacity,GreaterThan 1,"resources[4] , resources[6]",581,App Service must be deployed on a minimum of two instances to ensure availability,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_Multiple_Instances,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.sku.capacity,GreaterThan 1,"resources[8] , resources[10]",783,App Service must be deployed on a minimum of two instances to ensure availability,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_Multiple_Instances,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.sku.capacity,GreaterThan 1,"resources[12] , resources[13]",920,App Service must be deployed on a minimum of two instances to ensure availability,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_Multiple_Instances,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.sku.capacity,GreaterThan 1,"resources[22] , resources[21]",1421,App Service must be deployed on a minimum of two instances to ensure availability,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_Multiple_Instances,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.sku.capacity,GreaterThan 1,resources[24],1586,App Service must be deployed on a minimum of two instances to ensure availability,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_Multiple_Instances,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.sku.capacity,GreaterThan 1,"resources[28] , resources[27]",1729,App Service must be deployed on a minimum of two instances to ensure availability,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_AlwaysOn,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.alwaysOn | $.properties.alwaysOn,'True',"resources[0] , resources[2]",412,'Always On' should be configured for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_AlwaysOn,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.alwaysOn | $.properties.alwaysOn,'True',"resources[4] , resources[6]",581,'Always On' should be configured for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_AlwaysOn,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.alwaysOn | $.properties.alwaysOn,'True',"resources[8] , resources[10]",783,'Always On' should be configured for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_AlwaysOn,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.alwaysOn | $.properties.alwaysOn,'True',"resources[12] , resources[13]",920,'Always On' should be configured for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_AlwaysOn,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.alwaysOn | $.properties.alwaysOn,'True',"resources[22] , resources[21]",1421,'Always On' should be configured for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_AlwaysOn,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.alwaysOn | $.properties.alwaysOn,'True',"resources[28] , resources[27]",1729,'Always On' should be configured for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_SQLDatabase_Audit_Enable_Threat_Detection_Server,SqlServer,Failed,"Microsoft.Sql/servers , Microsoft.Sql/servers/databases , Microsoft.Sql/servers/databases/transparentDataEncryption , Microsoft.Sql/servers/databases/auditingSettings , Microsoft.Sql/servers/auditingSettings , Microsoft.Sql/servers/administrators , Microsoft.Sql/servers/securityAlertPolicies , Microsoft.Sql/servers/firewallrules",High,resources[6].properties.emailAddresses,1132,"""[parameters('teamEmailAddresses')]""",$.properties.emailAddresses,Non-null string,resources[6],1122,Enable SQL Server threat detection with email admins option. Do not exclude any detection types,D:\a\1\s\infrastructure\templates\template.json
Azure_SQLDatabase_Audit_Enable_Threat_Detection_Server,SqlServer,Failed,"Microsoft.Sql/servers , Microsoft.Sql/servers/databases , Microsoft.Sql/servers/databases/transparentDataEncryption , Microsoft.Sql/servers/databases/auditingSettings , Microsoft.Sql/servers/auditingSettings , Microsoft.Sql/servers/administrators , Microsoft.Sql/servers/securityAlertPolicies , Microsoft.Sql/servers/firewallrules",High,resources[4].properties.emailAddresses,1279,"""[parameters('teamEmailAddresses')]""",$.properties.emailAddresses,Non-null string,resources[4],1269,Enable SQL Server threat detection with email admins option. Do not exclude any detection types,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_Config_Disable_Remote_Debugging,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.remoteDebuggingEnabled | $.properties.remoteDebuggingEnabled,'False',resources[24],1586,Remote debugging must be turned off for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_Config_Disable_Web_Sockets,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.webSocketsEnabled | $.properties.webSocketsEnabled,'False',resources[24],1586,Web Sockets should be disabled for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_BCDR_Use_AlwaysOn,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.alwaysOn | $.properties.alwaysOn,'True',resources[24],1586,'Always On' should be configured for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_Deploy_Use_Latest_Version,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Low,Not found,-1,,$.properties.siteConfig.netFrameworkVersion | $.properties.netFrameworkVersion,Allow 'v4.7',resources[24],1586,The latest version of .NET framework version should be used for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.requestTracingEnabled | $.properties.requestTracingEnabled,'True',resources[24],1586,Auditing and Monitoring must be enabled for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.httpLoggingEnabled | $.properties.httpLoggingEnabled,'True',resources[24],1586,Auditing and Monitoring must be enabled for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.detailedErrorLoggingEnabled | $.properties.detailedErrorLoggingEnabled,'True',resources[24],1586,Auditing and Monitoring must be enabled for App Service,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_DP_Dont_Allow_HTTP_Access,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.httpsOnly,'True',resources[24],1586,App Service must only be accessible over HTTPS,D:\a\1\s\infrastructure\templates\template.json
Azure_AppService_DP_Use_Secure_TLS_Version,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.minTlsVersion | $.properties.minTlsVersion,GreaterThanOrEqual '1.2',resources[24],1586,Use approved version of TLS for the App Service,D:\a\1\s\infrastructure\templates\template.json